<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radium Engine: API: 3D objects (a.k.a. Meshes)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSsymbols.js", "TeX/AMSmath.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="radium-logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radium Engine
   &#160;<span id="projectnumber">1356bdac71d2ebb7992809d1c94404e5d5998469</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('develmeshes.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">API: 3D objects (a.k.a. Meshes) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md65">Geometry types</a></li>
<li class="level1"><a href="#autotoc_md66">Colaboration between Core and Engine</a></li>
<li class="level1"><a href="#autotoc_md67">Data consistency</a></li>
<li class="level1"><a href="#autotoc_md68">Mesh creation</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md65"></a>
Geometry types</h1>
<p>There is three kind of geometry representation included in radium source :</p><ol type="1">
<li><a class="el" href="namespaceRa_1_1Core_1_1Geometry.html">Ra::Core::Geometry</a>::*, which handles geometry data and connectivity as a indexed vertex array. Each vertex is a unique set of position, normal, and other attributes. If indexed, faces are defined with VectorXui, where X is 1 for point, 2 for lines, 3 for triangles, and N for polygons. See inheritance diagram of <a class="el" href="structRa_1_1Core_1_1Geometry_1_1AbstractGeometry.html">Ra::Core::Geometry::AbstractGeometry</a> :<ul>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html">Ra::Core::Geometry::AttribArrayGeometry</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1IndexedGeometry.html">Ra::Core::Geometry::IndexedGeometry</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1LineStrip.html">Ra::Core::Geometry::LineStrip</a> *</li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1PointCloud.html">Ra::Core::Geometry::PointCloud</a> *</li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1IndexedPointCloud.html">Ra::Core::Geometry::IndexedPointCloud</a> *</li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1LineMesh.html">Ra::Core::Geometry::LineMesh</a> *</li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1TriangleMesh.html">Ra::Core::Geometry::TriangleMesh</a> *</li>
</ul>
</li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1TopologicalMesh.html">Ra::Core::Geometry::TopologicalMesh</a>, which is an half-edge data structure. A converter allows to go back and forth to <code>TriangleMesh</code> without loss of data, but during the conversion, vertices with the same position represents the same topological point (and are hence merged). The other vertex attributes are stored on half-edges (to manage multiple normals per 3D positions for instance).</li>
<li><a class="el" href="namespaceRa_1_1Engine.html">Ra::Engine</a>::*, which stores a Core Geometry to handle 3D data, and manages the rendering aspect of it (VAO, VBO, draw call). See inheritance digram of <a class="el" href="classRa_1_1Engine_1_1AttribArrayDisplayable.html">Ra::Engine::AttribArrayDisplayable</a><ul>
<li><a class="el" href="classRa_1_1Engine_1_1Displayable.html">Ra::Engine::Displayable</a></li>
<li><a class="el" href="classRa_1_1Engine_1_1AttribArrayDisplayable.html">Ra::Engine::AttribArrayDisplayable</a></li>
<li><a class="el" href="classRa_1_1Engine_1_1CoreGeometryDisplayable.html" title="Template class to manage the Displayable aspect of a Core Geomertry, such as TriangleMesh. ">Ra::Engine::CoreGeometryDisplayable</a></li>
<li><a class="el" href="classRa_1_1Engine_1_1PointCloud.html" title="A PointCloud without indices. ">Ra::Engine::PointCloud</a> *</li>
<li><a class="el" href="classRa_1_1Engine_1_1IndexedGeometry.html" title="A CoreGeometry, with indices. ">Ra::Engine::IndexedGeometry</a></li>
<li><a class="el" href="classRa_1_1Engine_1_1IndexedAttribArrayDisplayable.html">Ra::Engine::IndexedAttribArrayDisplayable</a></li>
<li><a class="el" href="classRa_1_1Engine_1_1LineMesh.html" title="LineMesh, own a Core::Geometry::LineMesh. ">Ra::Engine::LineMesh</a> *</li>
<li><a class="el" href="classRa_1_1Engine_1_1Mesh.html" title="Mesh, own a Core::Geometry::TriangleMesh. ">Ra::Engine::Mesh</a> *</li>
</ul>
</li>
</ol>
<p><code>*</code> : the starred classes are the one you want to instanciate, the other are more for code factoring or abstraction.</p>
<h1><a class="anchor" id="autotoc_md66"></a>
Colaboration between Core and Engine</h1>
<p>A Core Geometry can be used on its own.</p>
<p>Engine Geometry must own a Core Geometry, either set at construction, or later with loadGeometry. The Core Geometry ownership is then transfered to the Engine Geometry, and can be accessed by reference with <a class="el" href="classRa_1_1Engine_1_1Displayable.html#a66e02e9b3b2abb1905d8df0ed77db017">Ra::Engine::Displayable::getAbstractGeometry</a> or <a class="el" href="classRa_1_1Engine_1_1CoreGeometryDisplayable.html#a6280c6ec1044cb9cba1eed2ee765ea67">Ra::Engine::CoreGeometryDisplayable::getCoreGeometry</a></p>
<h1><a class="anchor" id="autotoc_md67"></a>
Data consistency</h1>
<p>As soon as a Core Geometry is owned by a Engine Geometry, each data update on the Core Geometry attribute trigger a observator method to mark the corresponding GPU data as dirty. On the next <a class="el" href="classRa_1_1Engine_1_1CoreGeometryDisplayable.html#a82efcf23c3d3e74189e321dec3793cb5" title="Update (i.e. send to GPU) the buffers marked as dirty. ">Ra::Engine::CoreGeometryDisplayable::updateGL</a>, the dirty data will be updated on the GPU.</p>
<h1><a class="anchor" id="autotoc_md68"></a>
Mesh creation</h1>
<p><code>GeometryComponent</code> is in charge of loading a <code>GeometryData</code> and create the corresponding <code>Mesh</code>.</p>
<p>The user can add on the fly new vertex attributes to a <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html">Ra::Core::Geometry::AttribArrayGeometry</a> An attribute is defined by a unique name (std::string) and then represented as a <a class="el" href="classRa_1_1Core_1_1Utils_1_1AttribHandle.html" title="An attrib handle basically store an Index and a name. ">Ra::Core::Utils::AttribHandle</a>. The type of the attribute is defined by the caller using the template parameter of the method <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#ae1956b0396dadd84f55a12f2160e5671">Ra::Core::Geometry::AttribArrayGeometry::addAttrib</a>. To ensure consistency, it is strongly recommended to store the handle returned by the <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#ae1956b0396dadd84f55a12f2160e5671">Ra::Core::Geometry::AttribArrayGeometry::addAttrib</a> method: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> handle1 = m.addAttrib&lt;<a class="code" href="classCore_1_1Vector3.html">Vector3</a>&gt;( <span class="stringliteral">&quot;vector3_attrib&quot;</span> );</div></div><!-- fragment --><p> Attribute names <code>in_position</code> and <code>in_normals</code> are reserved. Note that handles to existing attributes can be retrieved by name (see <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#aeb68d9cd8cf8c1e05886a23f0ad33c59">Ra::Core::Geometry::AttribArrayGeometry::getAttrib</a>), however the caller have to provide the type of the associate attribute. There is no type check on this access, and we recommend not to use this. We keep this method for convenience in some specific cases such as copy of attributes, however note that it might be marked as deprecated at any time.</p>
<p>There is no (in the current version) data checking, and attributes are simple <code>std::vector</code>s added to the attribute manager. It's meant to be used as vector of data, such as vertices and normals, with the same size and accessed with the vertices indices. But please be aware no check nor allocation are done, so the allocation has to be performed on client side.</p>
<p>When copying a <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html">Ra::Core::Geometry::AttribArrayGeometry</a> or one of its descendent class, all its attributes are copied, unless it is done through <a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a1828a9428b47dc4a3f5cebec0681fc83">Ra::Core::Geometry::AttribArrayGeometry::copyBaseGeometry</a>, for which no attribute is copied. In order to copy some/all of the attributes, the dedicated methods must be used.</p>
<p>Attribute writes must be with "lock" to ensure data syncronisation. Utility methods are provided for position and normals :</p>
<ul>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a887411177386edbcdc35d0c6bf78a83a" title="Set vertices. ">Ra::Core::Geometry::AttribArrayGeometry::setVertices</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a7f57cb8c0c0a79c2c69bffe5b8a20357">Ra::Core::Geometry::AttribArrayGeometry::verticesWithLock</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a815c49137e348ae161fb3762f8c5b1ab" title="Release lock on vertices positions. ">Ra::Core::Geometry::AttribArrayGeometry::verticesUnlock</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a646faabae9b936589fe03d8a9d2002e9" title="Set normals. ">Ra::Core::Geometry::AttribArrayGeometry::setNormals</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a365e4d1e66fb093b775a17562408126c">Ra::Core::Geometry::AttribArrayGeometry::normalsWithLock</a></li>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a71452620a83df6e6f6b995a503dc8a52" title="Release lock on vertices normals. ">Ra::Core::Geometry::AttribArrayGeometry::normalsUnlock</a></li>
</ul>
<p>Others attributes are written with :</p><ul>
<li><a class="el" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#aeb68d9cd8cf8c1e05886a23f0ad33c59">Ra::Core::Geometry::AttribArrayGeometry::getAttrib</a> to get an attrib handle</li>
<li><a class="el" href="classRa_1_1Core_1_1Utils_1_1Attrib.html#a1aecf7dfdda7433ca789f8880b2fdb43">Ra::Core::Utils::Attrib::setData</a> to set the data directly or</li>
<li><a class="el" href="classRa_1_1Core_1_1Utils_1_1Attrib.html#a36eee2128af8869a7dafebb8fc60690f">Ra::Core::Utils::Attrib::getDataWithLock</a> to get a writable reference to the data array</li>
<li><a class="el" href="classRa_1_1Core_1_1Utils_1_1AttribBase.html#a7d1e21999ec3d5af8909d400f6cf3dfe" title="Unlock data so another one can gain write access. ">Ra::Core::Utils::Attrib::unlock</a> to release the writable reference</li>
</ul>
<p>For instance</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="classRa_1_1Core_1_1Geometry_1_1TriangleMesh.html">Ra::Core::Geometry::TriangleMesh</a>;</div><div class="line">TriangleMesh m;</div><div class="line">TriangleMesh::PointAttribHandle::Container vertices;</div><div class="line">TriangleMesh::NormalAttribHandle::Container normals;</div><div class="line"></div><div class="line">vertices.push_back( {0, 0, 0} );</div><div class="line">vertices.push_back( {1, 0, 0} );</div><div class="line">vertices.push_back( {0, 2, 0} );</div><div class="line">normals.push_back( {0, 0, 1} );</div><div class="line">normals.push_back( {0, 0, 1} );</div><div class="line">normals.push_back( {0, 0, 1} );</div><div class="line"></div><div class="line">m.<a class="code" href="classRa_1_1Core_1_1Geometry_1_1AttribArrayGeometry.html#a887411177386edbcdc35d0c6bf78a83a">setVertices</a>( std::move( vertices ) );</div><div class="line">m.setNormals( std::move( normals ) );</div><div class="line"></div><div class="line">m.m_indices.push_back( {0, 1, 2} );</div><div class="line"><span class="keyword">auto</span> handle1  = m.addAttrib&lt;<a class="code" href="classCore_1_1Vector3.html">Vector3</a>&gt;( <span class="stringliteral">&quot;vector3_attrib&quot;</span> );</div><div class="line"><span class="keyword">auto</span>&amp; attrib1 = m.getAttrib( handle1 );</div><div class="line"><span class="keyword">auto</span>&amp; buf     = attrib1.getDataWithLock();</div><div class="line"></div><div class="line">buf.reserve( 3 );</div><div class="line">buf.push_back( {1, 1, 1} );</div><div class="line">buf.push_back( {2, 2, 2} );</div><div class="line">buf.push_back( {3, 3, 3} );</div><div class="line">attrib1.unlock();</div><div class="line"></div><div class="line"><span class="keyword">auto</span> handle2  = m.addAttrib&lt;<span class="keywordtype">float</span>&gt;( <span class="stringliteral">&quot;float_attrib&quot;</span> );</div><div class="line"><span class="keyword">auto</span>&amp; attrib2 = m.getAttrib( handle2 );</div><div class="line">attrib2.setData( {1.f, 2.f, 3.f} );</div><div class="line"></div><div class="line">TriangleMesh m2;</div><div class="line">m2.copyBaseGeometry( m );</div><div class="line">m2.copyAttributes( m, handle1 );</div></div><!-- fragment --><p>Other examples are provided in <a class="el" href="DrawPrimitives_8cpp.html">DrawPrimitives.cpp</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="develmanual.html">Developer manual</a></li><li class="navelem"><a class="el" href="api.html">API</a></li><li class="navelem"><a class="el" href="core.html">Core</a></li>
    <li class="footer">Generated on Mon May 4 2020 12:45:37 for Radium Engine by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
